@import url('https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700;900&family=Cinzel:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap');

@font-face {
  font-family: 'Papyrus';
  src: url('@assets/Papyrus_0_1759833643028.otf') format('opentype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'Angst';
  src: url('/fonts/angst-boldserif.otf') format('opentype');
  font-weight: bold;
  font-style: normal;
}

@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --radius: 0.75rem;
  
  /* Magical Color System */
  --background: hsl(227 39% 11%);
  --foreground: hsl(200 6.6667% 91.1765%);
  --card: hsl(232 45% 14%);
  --card-foreground: hsl(200 6.6667% 91.1765%);
  --popover: hsl(232 45% 14%);
  --popover-foreground: hsl(200 6.6667% 91.1765%);
  --primary: hsl(259 74% 56%);
  --primary-foreground: hsl(200 6.6667% 91.1765%);
  --secondary: hsl(33 92% 50%);
  --secondary-foreground: hsl(232 45% 14%);
  --muted: hsl(215 20% 32%);
  --muted-foreground: hsl(220 9% 61%);
  --accent: hsl(217 91% 60%);
  --accent-foreground: hsl(200 6.6667% 91.1765%);
  --destructive: hsl(2 90% 50%);
  --destructive-foreground: hsl(200 6.6667% 91.1765%);
  --border: hsl(261 85% 73%);
  --input: hsl(215 20% 32%);
  --ring: hsl(259 74% 56%);
  
  /* Chart colors */
  --chart-1: hsl(259 74% 56%);
  --chart-2: hsl(160 100% 36%);
  --chart-3: hsl(33 92% 50%);
  --chart-4: hsl(147 79% 42%);
  --chart-5: hsl(341 75% 51%);
  
  /* Fonts */
  --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
  --font-serif: 'Papyrus', 'Cinzel', serif;
  --font-decorative: 'Cinzel Decorative', serif;
  --font-mono: 'JetBrains Mono', monospace;
  
  /* Shadows with magical glow */
  --shadow-2xs: 0px 2px 0px 0px hsl(259 74% 56% / 0.1);
  --shadow-xs: 0px 2px 0px 0px hsl(259 74% 56% / 0.1);
  --shadow-sm: 0px 2px 0px 0px hsl(259 74% 56% / 0.1), 0px 1px 2px -1px hsl(259 74% 56% / 0.1);
  --shadow: 0px 2px 0px 0px hsl(259 74% 56% / 0.1), 0px 1px 2px -1px hsl(259 74% 56% / 0.1);
  --shadow-md: 0px 2px 0px 0px hsl(259 74% 56% / 0.1), 0px 2px 4px -1px hsl(259 74% 56% / 0.1);
  --shadow-lg: 0px 2px 0px 0px hsl(259 74% 56% / 0.1), 0px 4px 6px -1px hsl(259 74% 56% / 0.1);
  --shadow-xl: 0px 2px 0px 0px hsl(259 74% 56% / 0.1), 0px 8px 10px -1px hsl(259 74% 56% / 0.1);
  --shadow-2xl: 0px 2px 0px 0px hsl(259 74% 56% / 0.1);
  
  --spacing: 0.25rem;
}

.dark {
  --background: hsl(227 39% 11%);
  --foreground: hsl(200 6.6667% 91.1765%);
  --card: hsl(232 45% 14%);
  --card-foreground: hsl(200 6.6667% 91.1765%);
  --popover: hsl(232 45% 14%);
  --popover-foreground: hsl(200 6.6667% 91.1765%);
  --primary: hsl(259 74% 56%);
  --primary-foreground: hsl(200 6.6667% 91.1765%);
  --secondary: hsl(33 92% 50%);
  --secondary-foreground: hsl(232 45% 14%);
  --muted: hsl(215 20% 32%);
  --muted-foreground: hsl(220 9% 61%);
  --accent: hsl(217 91% 60%);
  --accent-foreground: hsl(200 6.6667% 91.1765%);
  --destructive: hsl(2 90% 50%);
  --destructive-foreground: hsl(200 6.6667% 91.1765%);
  --border: hsl(261 85% 73%);
  --input: hsl(215 20% 32%);
  --ring: hsl(259 74% 56%);
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply font-sans antialiased bg-gradient-to-br from-background via-background to-purple-900/20 text-foreground min-h-screen overflow-x-hidden;
  }
}

/* Magical Background Effects */
.magical-bg {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
  background: 
    radial-gradient(circle at 20% 30%, hsl(259 74% 56% / 0.1) 0%, transparent 40%),
    radial-gradient(circle at 80% 70%, hsl(217 91% 60% / 0.08) 0%, transparent 40%),
    radial-gradient(circle at 50% 50%, hsl(33 92% 50% / 0.05) 0%, transparent 50%);
}

/* Glowing Effects */
.glow-primary {
  box-shadow: 0 0 20px hsl(259 74% 56% / 0.3), 0 0 40px hsl(259 74% 56% / 0.15);
}

.glow-secondary {
  box-shadow: 0 0 20px hsl(33 92% 50% / 0.3), 0 0 40px hsl(33 92% 50% / 0.15);
}

.glow-destructive {
  box-shadow: 0 0 20px hsl(2 90% 50% / 0.4), 0 0 40px hsl(2 90% 50% / 0.2);
}

/* Border Glow Effect (no shadow) */
.border-glow-primary {
  border: 2px solid hsl(259 74% 56% / 0.6);
}

/* Spell Cards */
.spell-card {
  background: linear-gradient(135deg, hsl(232 45% 14% / 0.6) 0%, hsl(235 55% 18% / 0.6) 100%);
  backdrop-filter: blur(10px);
  border: 1px solid hsl(261 85% 73% / 0.2);
  transition: all 0.3s ease;
}

.spell-card:hover {
  border-color: hsl(261 85% 73% / 0.5);
  transform: translateY(-2px);
}

/* Canvas Styles */
.canvas-container canvas {
  cursor: crosshair;
  background: hsl(232 45% 14% / 0.3);
  border: 2px solid hsl(261 85% 73% / 0.3);
  border-radius: var(--radius);
  transition: all 0.3s ease;
}

.canvas-container canvas:hover {
  border-color: hsl(261 85% 73% / 0.6);
  box-shadow: 0 0 30px hsl(259 74% 56% / 0.2);
}

/* Player Turn Indicator */
.player-active {
  background: linear-gradient(135deg, hsl(259 74% 56% / 0.3) 0%, hsl(217 91% 60% / 0.3) 100%);
  border: 2px solid hsl(259 74% 56% / 0.6);
}

/* Accuracy Meter */
.accuracy-bar {
  background: linear-gradient(90deg, hsl(2 90% 50%) 0%, hsl(33 92% 50%) 50%, hsl(120 70% 50%) 100%);
  height: 8px;
  border-radius: 9999px;
  transition: width 0.5s ease;
}

/* Animated Particles */
@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-20px); }
}

.floating {
  animation: float 6s ease-in-out infinite;
}

/* Pulse Animation */
@keyframes pulse-glow {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

/* Modal Overlay */
.modal-overlay {
  background: hsl(227 39% 8% / 0.9);
  backdrop-filter: blur(8px);
}

/* Font Utilities */
.font-decorative {
  font-family: var(--font-decorative);
}

/* Custom Decorative Text */
.decorative-text {
  font-family: var(--font-decorative);
  background: linear-gradient(135deg, hsl(259 74% 56%) 0%, hsl(217 91% 60%) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 0 30px hsl(259 74% 56% / 0.5);
}

/* Angst Font for Main Titles */
.font-angst {
  font-family: 'Angst', var(--font-decorative);
  font-weight: bold;
}

/* Mobile Landscape: Optimize desktop layout for narrow screens */
@media only screen and (max-width: 1023px) and (orientation: landscape) {
  body {
    overflow-x: hidden;
  }
  
  /* Reduce overall padding */
  .p-4,
  .p-6,
  .p-8 {
    padding: 0.5rem !important;
  }
  
  /* Tighter gaps in grids */
  .gap-6 {
    gap: 0.75rem !important;
  }
  
  .gap-4 {
    gap: 0.5rem !important;
  }
  
  /* Reduce margins */
  .mb-8,
  .mb-12 {
    margin-bottom: 1rem !important;
  }
  
  .mb-6 {
    margin-bottom: 0.75rem !important;
  }
  
  .mb-4 {
    margin-bottom: 0.5rem !important;
  }
  
  /* Smaller text sizes but still readable */
  .text-4xl,
  .text-5xl,
  .text-6xl,
  .text-7xl {
    font-size: 1.5rem !important;
    line-height: 2rem !important;
  }
  
  .text-3xl {
    font-size: 1.25rem !important;
    line-height: 1.75rem !important;
  }
  
  .text-2xl {
    font-size: 1.125rem !important;
    line-height: 1.75rem !important;
  }
  
  .text-xl {
    font-size: 1rem !important;
    line-height: 1.5rem !important;
  }
  
  .text-lg {
    font-size: 0.9375rem !important;
    line-height: 1.5rem !important;
  }
  
  /* Smaller canvas to fit in narrower column */
  .canvas-container canvas {
    max-width: 95% !important;
    max-height: 280px !important;
  }
  
  /* Tighter content padding */
  .max-w-7xl {
    padding-left: 0.5rem;
    padding-right: 0.5rem;
  }
  
  /* Slightly smaller player cards but still readable */
  .spell-card {
    font-size: 0.9375rem; /* 15px - minimum for accessibility */
  }
  
  /* Reduce icon sizes to save space */
  .w-12 {
    width: 2.5rem !important;
    height: 2.5rem !important;
  }
  
  .w-10 {
    width: 2rem !important;
    height: 2rem !important;
  }
  
  /* Constrain gesture pattern SVG in dialog for mobile landscape */
  [data-testid="dialog-gesture-pattern"] .aspect-square {
    max-width: 250px !important;
  }
}

/* Mobile: Compact role selection cards to fit side by side */
@media only screen and (max-width: 640px) {
  /* Reduce card padding on mobile */
  [data-testid="card-role-player"] .p-6,
  [data-testid="card-role-spectator"] .p-6 {
    padding: 0.75rem !important;
  }
  
  /* Reduce header padding */
  [data-testid="card-role-player"] > div:first-child,
  [data-testid="card-role-spectator"] > div:first-child {
    padding: 0.75rem !important;
    padding-bottom: 0.5rem !important;
  }
  
  /* Reduce content padding */
  [data-testid="card-role-player"] > div:last-child,
  [data-testid="card-role-spectator"] > div:last-child {
    padding: 0.75rem !important;
    padding-top: 0.5rem !important;
  }
}

/* Sparkle (пыльца) вокруг имени активного игрока */
@keyframes spark1 {
  0%   { opacity: 0; transform: translate(0, 0) scale(0.7); }
  20%  { opacity: 1; }
  100% { opacity: 0; transform: translate(10px, -8px) scale(0.1); }
}

@keyframes spark2 {
  0%   { opacity: 0; transform: translate(0, 0) scale(0.7); }
  20%  { opacity: 1; }
  100% { opacity: 0; transform: translate(-12px, 6px) scale(0.1); }
}

.sparkle {
  position: relative;
}

.sparkle::before,
.sparkle::after {
  content: "";
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--house-color, #ffffff);
  pointer-events: none;
  filter: drop-shadow(0 0 4px var(--house-color, #ffffff));
}

.sparkle::before {
  top: -0.35em;
  left: -0.25em;
  animation: spark1 750ms ease-out;
}

.sparkle::after {
  bottom: -0.35em;
  right: -0.35em;
  animation: spark2 820ms ease-out 60ms;
}

@media (prefers-reduced-motion: reduce) {
  .sparkle::before,
  .sparkle::after { animation: none !important; }
}

/* Волна‑подчёркивание под именем (градиент слева направо) */
@keyframes underlineWave {
  0%   { opacity: 0; background-position: -120% 0; }
  10%  { opacity: 1; }
  100% { opacity: 0; background-position: 120% 0; }
}

.wave-underline {
  position: relative;
  display: inline-block;
}

.wave-underline::after {
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  bottom: -0.2em;
  height: 2px;
  border-radius: 2px;
  background: linear-gradient(
    90deg,
    transparent 0%,
    color-mix(in oklab, var(--house-color, #ffffff) 40%, black 0%) 18%,
    var(--house-color, #ffffff) 50%,
    color-mix(in oklab, var(--house-color, #ffffff) 40%, black 0%) 82%,
    transparent 100%
  );
  background-size: 220% 100%;
  animation: underlineWave 900ms ease-out;
  filter: drop-shadow(0 0 2px var(--house-color, #ffffff));
}

@media (prefers-reduced-motion: reduce) {
  .wave-underline::after { animation: none !important; }
}
